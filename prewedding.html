<!DOCTYPE html>
<html>
<head>
  <title>Pre-Wedding Photography</title>
  <style>
    body{font-family:Arial;background:#f5f5f5;text-align:center;margin:0}
    h1{margin-top:40px}
    #uploadBox{display:none;margin:30px}
    #uploadBox label{background:black;color:white;padding:12px 20px;border-radius:6px;cursor:pointer}
    .gallery{display:flex;justify-content:center;gap:30px;flex-wrap:wrap;margin-top:40px}
    .photo-box{width:280px;height:200px;border:1px solid #ccc;background:white;display:flex;align-items:center;justify-content:center}
    .photo-wrapper{position:relative;width:100%;height:100%;cursor:pointer}
    .photo-wrapper img{max-width:100%;max-height:100%}
    .delete-btn{position:absolute;top:6px;right:6px;background:rgba(0,0,0,.7);color:white;border:none;border-radius:50%;width:26px;height:26px;cursor:pointer;display:none}
    .photo-wrapper:hover .delete-btn{display:block}
    #lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);display:none;align-items:center;justify-content:center;z-index:999}
    #lightbox img{max-width:90%;max-height:90%}
    #closeBtn{position:absolute;top:20px;right:30px;font-size:30px;color:white;cursor:pointer}
  </style>
</head>
<body>

<h1>Pre-Wedding Photography</h1>

<div id="uploadBox">
  <label for="fileInput">ðŸ“¤ Upload Photos</label>
  <input type="file" id="fileInput" accept="image/*" multiple style="display:none" onchange="uploadImages(event)">
</div>

<div class="gallery" id="gallery">
  <div class="photo-box"></div>
  <div class="photo-box"></div>
  <div class="photo-box"></div>
</div>

<div id="lightbox" ondblclick="closeImage()">
  <span id="closeBtn" onclick="closeImage()">âœ–</span>
  <img id="lightboxImg">
</div>

<script>
const ADMIN_EMAIL="sitharasanthosh273@gmail.com";
const MODULE="prewedding";
const isAdmin=localStorage.getItem("userEmail")===ADMIN_EMAIL;
if(isAdmin)document.getElementById("uploadBox").style.display="block";

fetch(`http://localhost:3000/images/${MODULE}`)
.then(r=>r.json()).then(images=>{
  const g=document.getElementById("gallery");
  const boxes=g.querySelectorAll(".photo-box");
  let i=0;
  images.forEach(name=>{
    let box=i<boxes.length?boxes[i]:(()=>{let b=document.createElement("div");b.className="photo-box";g.appendChild(b);return b})()
    let w=document.createElement("div");w.className="photo-wrapper";
    let img=document.createElement("img");
    img.src=`http://localhost:3000/uploads/${MODULE}/${name}`;
    img.ondblclick=()=>openImage(img.src);
    w.appendChild(img);
    if(isAdmin){
      let d=document.createElement("button");
      d.className="delete-btn";d.innerText="â‹®";
      d.onclick=()=>deleteImage(name);
      w.appendChild(d);
    }
    box.appendChild(w);i++;
  })
});

function uploadImages(e){
  const fd=new FormData();
  for(let f of e.target.files)fd.append("images",f);
  fetch(`http://localhost:3000/upload/${MODULE}`,{method:"POST",body:fd})
  .then(()=>location.reload());
}
function deleteImage(n){
  if(!confirm("Delete this image?"))return;
  fetch(`http://localhost:3000/delete/${MODULE}/${n}`,{method:"DELETE"})
  .then(()=>location.reload());
}
function openImage(src){
  document.getElementById("lightboxImg").src=src;
  document.getElementById("lightbox").style.display="flex";
}
function closeImage(){document.getElementById("lightbox").style.display="none";}
</script>
</body>
</html>
